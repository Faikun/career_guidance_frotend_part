{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"test__questionCounter\"\n};\nconst _hoisted_2 = {\n  class: \"test__question\"\n};\nconst _hoisted_3 = {\n  class: \"test__question-name\"\n};\nconst _hoisted_4 = {\n  class: \"test__question-answers\"\n};\nconst _hoisted_5 = {\n  class: \"test__passed\"\n};\nconst _hoisted_6 = {\n  class: \"test__questionNums\"\n};\nconst _hoisted_7 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, \"Вопрос \" + _toDisplayString($setup.questionNum + 1), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, _toDisplayString($setup.allTest[$setup.questionNum].question), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n    class: \"test__question-answer\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.nextQuestion($setup.questionNum, $setup.allTest[$setup.questionNum], $setup.allTest[$setup.questionNum].score))\n  }, \"Да\"), _createElementVNode(\"div\", {\n    class: \"test__question-answer\",\n    onClick: _cache[1] || (_cache[1] = $event => $setup.nextQuestion($setup.questionNum, $setup.allTest[$setup.questionNum], $setup.allTest[$setup.questionNum].score * -1))\n  }, \"Нет\"), _createElementVNode(\"div\", {\n    class: \"test__question-answer\",\n    onClick: _cache[2] || (_cache[2] = $event => $setup.nextQuestion($setup.questionNum, $setup.allTest[$setup.questionNum], 0))\n  }, \"Затрудняюсь ответить\")])]), _createCommentVNode(\" ./test__question \"), _createElementVNode(\"div\", _hoisted_5, \" Вы ответили на \" + _toDisplayString($setup.checkQuestionCompleted) + \" из \" + _toDisplayString($setup.allTest.length) + \" вопросов \", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_6, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.allTest.length, num => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      class: _normalizeClass([$setup.allTest[num - 1].isAnswered ? 'active' : '', \"test__questionNum\"]),\n      onClick: $event => $setup.questionNum = num - 1\n    }, _toDisplayString(num), 11 /* TEXT, CLASS, PROPS */, _hoisted_7);\n  }), 256 /* UNKEYED_FRAGMENT */))]), _createCommentVNode(\" ./test__questionNums \")], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"names":["class","_createElementVNode","_hoisted_1","_toDisplayString","$setup","questionNum","_hoisted_2","_hoisted_3","allTest","question","_hoisted_4","onClick","_cache","$event","nextQuestion","score","_createCommentVNode","_hoisted_5","checkQuestionCompleted","length","_hoisted_6","_createElementBlock","_Fragment","_renderList","num","_normalizeClass","isAnswered","_hoisted_7"],"sources":["E:\\Vue\\career_guidance\\src\\components\\TestTemplate.vue"],"sourcesContent":["<template>\r\n  <div class=\"test__questionCounter\">Вопрос {{ questionNum + 1 }}</div>\r\n\r\n  <div class=\"test__question\">\r\n    <div class=\"test__question-name\"> {{ allTest[questionNum].question }}</div>\r\n    <div class=\"test__question-answers\">\r\n      <div class=\"test__question-answer\" @click=\"nextQuestion(questionNum, allTest[questionNum], allTest[questionNum].score)\">Да</div>\r\n      <div class=\"test__question-answer\" @click=\"nextQuestion(questionNum, allTest[questionNum], allTest[questionNum].score * -1)\">Нет</div>\r\n      <div class=\"test__question-answer\" @click=\"nextQuestion(questionNum, allTest[questionNum], 0)\">Затрудняюсь ответить</div>\r\n    </div>\r\n  </div><!-- ./test__question -->\r\n  <div class=\"test__passed\">\r\n    Вы ответили на\r\n    {{ checkQuestionCompleted }}\r\n    из {{ allTest.length }} вопросов\r\n  </div>\r\n  <div class=\"test__questionNums\">\r\n    <div\r\n        :class=\"allTest[num-1].isAnswered ? 'active': ''\"\r\n        v-for=\"num in allTest.length\"\r\n        @click=\"questionNum = num-1\"\r\n        class=\"test__questionNum\">{{ num }}</div>\r\n  </div><!-- ./test__questionNums -->\r\n</template>\r\n\r\n<script>\r\nimport {computed, ref} from \"vue\";\r\nimport {useStore} from \"vuex\";\r\nimport {useRoute} from \"vue-router\";\r\nimport router from \"@/router\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"TestTemplate\",\r\n  props: ['name'],\r\n  async setup(props) {\r\n    let questionNum = ref(0);\r\n    const store = useStore();\r\n    const route = useRoute();\r\n\r\n    await store.dispatch(\"initialQuestionList\");\r\n\r\n    const tests = computed(() => store.getters.getTests);\r\n    const users = computed(() => store.getters.getUsers);\r\n    const routeName = computed(() => route.params.name);\r\n    const test = tests.value.filter((el) => el.name === routeName.value)[0].questions;\r\n    let allTest = []\r\n\r\n    for (let i = 0; i < test.length; i++) {\r\n      const innerArray = test[i].questions;\r\n      for (let j = 0; j < innerArray.length; j++) {\r\n        allTest.push(innerArray[j]);\r\n        allTest[allTest.length-1]['isAnswered'] = false;\r\n        allTest[allTest.length-1]['name'] = test[i].name;\r\n      }\r\n    }\r\n\r\n    let firstUnanswered = computed(() => test.findIndex(test => test.isAnswered === false));\r\n    let checkQuestionCompleted = computed(() => allTest.reduce((accumulator, currentValue) => accumulator + (currentValue.isAnswered ? 1 : 0), 0));\r\n\r\n    const sendAnswers = async function (chosenAns) {\r\n      const config = {\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        params: {\r\n          keyName: chosenAns\r\n        }\r\n      }\r\n      let {data} = await axios.post('profession/getProfessionsByKey', null, config)\r\n      return data\r\n    }\r\n\r\n    function shuffleArray(array) {\r\n      for (let i = array.length - 1; i > 0; i--) {\r\n        const j = Math.floor(Math.random() * (i + 1));\r\n        [array[i], array[j]] = [array[j], array[i]];\r\n      }\r\n      return array;\r\n    }\r\n\r\n    let total = {\r\n      'человек-природа' : 0,\r\n      'человек-техника' : 0,\r\n      'человек-знаковая система' : 0,\r\n      'человек-искусство' : 0,\r\n      'человек-человек' : 0\r\n    };\r\n\r\n    function getMaxKeys(obj) {\r\n      let max = -Infinity;\r\n      let maxKeys = [];\r\n\r\n      for (let key in obj) {\r\n        let val = obj[key];\r\n        if (typeof val === 'number' && val >= max) {\r\n          if (val > max) {\r\n            max = val;\r\n            maxKeys = [key];\r\n          } else {\r\n            maxKeys.push(key);\r\n          }\r\n        }\r\n      }\r\n\r\n      return maxKeys;\r\n    }\r\n\r\n\r\n    let nextQuestion = async function (question, answer, chosenAnswer) {\r\n      if (checkQuestionCompleted.value + 1 !== allTest.length) {\r\n        allTest[question].isAnswered = true\r\n        total[allTest[question].name] += chosenAnswer\r\n        if (firstUnanswered.value > -1) {\r\n          questionNum.value = firstUnanswered.value;\r\n        } else {\r\n          questionNum.value++;\r\n        }\r\n      }\r\n      else {\r\n        let max = getMaxKeys(total)\r\n        let result = [];\r\n        for (let i = 0; i < max.length; i++) {\r\n          let data = await sendAnswers(getMaxKeys(total)[i]);\r\n          result.push(data)\r\n        }\r\n\r\n        let newResult = []\r\n\r\n        for (let i = 0; i < result[0].length; i++) {\r\n          newResult.push({name: result[0][i].name, description: result[0][i].description})\r\n        }\r\n\r\n        let a = \"[[\\\"инженер-конструктор\\\",\\\"этот специалист занимается проектированием технических объектов и разработкой технологий производства. Для успешной работы необходимо точное измерение объектов, техническое мышление и способность к творческому подходу в решении задач.\\\"],[\\\"архитектор\\\",\\\"проектирование и создание архитектурных объектов, построек и комплексов требует точности измерений, практического мышления и технической фантазии для создания уникальных и эффективных проектов.\\\"],[\\\"it-специалист\\\",\\\"в сфере информационных технологий точность и определенность действий являются основными качествами для разработки, преобразования и обработки данных, а также разработки программного обеспечения.\\\"],[\\\"механик\\\",\\\"этот специалист занимается обслуживанием и ремонтом механических устройств, которые должны быть точно измерены и преобразованы в соответствии с требованиями технических спецификаций.\\\"],[\\\"строитель\\\",\\\"при строительстве зданий и сооружений необходимо соблюдать точные измерения и установленные технические нормы, что требует практического мышления и технической фантазии при разработке конструктивных решений.\\\"]]\"\r\n        if (store.getters.getAuth) {\r\n          const {data} = await axios.post('history', {\r\n            name: props.name,\r\n            result: JSON.stringify(newResult).substring(0, 50)\r\n          })\r\n\r\n          await axios.patch('user/' + store.getters.getUserId, {\r\n            id: data.id,\r\n            name: props.name,\r\n            result: \"JSON.stringify(result)\"\r\n          })\r\n\r\n          users.value.filter((el) => el.id.toString() === store.getters.getUserId)[0].history = JSON.stringify(history);\r\n        }\r\n        else {\r\n          localStorage.setItem('test', JSON.stringify(result));\r\n        }\r\n        setTimeout(() => {\r\n          router.push('/result');\r\n        }, 250);\r\n      }\r\n    }\r\n    return {\r\n      questionNum,\r\n      test,\r\n      nextQuestion,\r\n      checkQuestionCompleted,\r\n      allTest: shuffleArray(allTest)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"mappings":";;EACOA,KAAK,EAAC;AAAuB;;EAE7BA,KAAK,EAAC;AAAgB;;EACpBA,KAAK,EAAC;AAAqB;;EAC3BA,KAAK,EAAC;AAAwB;;EAMhCA,KAAK,EAAC;AAAc;;EAKpBA,KAAK,EAAC;AAAoB;;;6DAf/BC,mBAAA,CAAqE,OAArEC,UAAqE,EAAlC,SAAO,GAAAC,gBAAA,CAAGC,MAAA,CAAAC,WAAW,sBAExDJ,mBAAA,CAOM,OAPNK,UAOM,GANJL,mBAAA,CAA2E,OAA3EM,UAA2E,EAAAJ,gBAAA,CAAtCC,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW,EAAEI,QAAQ,kBAClER,mBAAA,CAIM,OAJNS,UAIM,GAHJT,mBAAA,CAAgI;IAA3HD,KAAK,EAAC,uBAAuB;IAAEW,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAET,MAAA,CAAAU,YAAY,CAACV,MAAA,CAAAC,WAAW,EAAED,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW,GAAGD,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW,EAAEU,KAAK;KAAG,IAAE,GAC1Hd,mBAAA,CAAsI;IAAjID,KAAK,EAAC,uBAAuB;IAAEW,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAET,MAAA,CAAAU,YAAY,CAACV,MAAA,CAAAC,WAAW,EAAED,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW,GAAGD,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW,EAAEU,KAAK;KAAQ,KAAG,GAChId,mBAAA,CAAyH;IAApHD,KAAK,EAAC,uBAAuB;IAAEW,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAET,MAAA,CAAAU,YAAY,CAACV,MAAA,CAAAC,WAAW,EAAED,MAAA,CAAAI,OAAO,CAACJ,MAAA,CAAAC,WAAW;KAAO,sBAAoB,E,KAEjHW,mBAAA,sBAAyB,EAC/Bf,mBAAA,CAIM,OAJNgB,UAIM,EAJoB,kBAExB,GAAAd,gBAAA,CAAGC,MAAA,CAAAc,sBAAsB,IAAG,MACzB,GAAAf,gBAAA,CAAGC,MAAA,CAAAI,OAAO,CAACW,MAAM,IAAG,YACzB,iBACAlB,mBAAA,CAMM,OANNmB,UAMM,I,kBALJC,mBAAA,CAI6CC,SAAA,QAAAC,WAAA,CAF3BnB,MAAA,CAAAI,OAAO,CAACW,MAAM,EAArBK,GAAG;yBAFdH,mBAAA,CAI6C;MAHxCrB,KAAK,EAAAyB,eAAA,EAAErB,MAAA,CAAAI,OAAO,CAACgB,GAAG,MAAIE,UAAU,kBAG3B,mBAAmB;MADxBf,OAAK,EAAAE,MAAA,IAAET,MAAA,CAAAC,WAAW,GAAGmB,GAAG;wBACIA,GAAG,gCAAAG,UAAA;sCAChCX,mBAAA,0BAA6B,C"},"metadata":{},"sourceType":"module","externalDependencies":[]}