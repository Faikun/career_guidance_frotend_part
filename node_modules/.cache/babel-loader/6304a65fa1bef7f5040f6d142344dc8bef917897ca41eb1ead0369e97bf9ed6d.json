{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { computed, onMounted, reactive, ref, watch } from \"vue\";\nimport { useStore } from \"vuex\";\nimport axios from \"axios\";\nexport default {\n  name: \"AdminUser\",\n  setup() {\n    onMounted(async () => await store.dispatch(\"setAllUsers\"));\n    let store = useStore();\n    let users = computed(() => store.getters.getUsers);\n    let inputDisabled = reactive([]);\n    for (let i = 0; i < users.value.length; i++) {\n      inputDisabled.push(false);\n    }\n    let newUser = reactive({\n      username: '',\n      email: '',\n      password: '',\n      status: 'ROLE_USER',\n      location: 'Almaty'\n    });\n    let newUsers = document.getElementsByClassName('newUser');\n    const userName = ref(''),\n      userMail = ref(''),\n      userPassword = ref(''),\n      userStatus = ref(''),\n      userLocation = ref('');\n    const editClick = function (index) {\n      inputDisabled[index] = !inputDisabled[index];\n      userPassword.value[index].value = '';\n    };\n    let saveData = async function (user, index) {\n      let data = {\n        username: userName.value[index].value,\n        email: userMail.value[index].value,\n        role: userStatus.value[index].value,\n        location: userLocation.value[index].value\n      };\n      if (userPassword.value[index].value) {\n        data[\"password\"] = userPassword.value[index].value;\n      }\n      axios.put('user/' + user.id, data).then(e => store.dispatch('setAllUsers')).catch(el => console.log(el.message));\n      userPassword.value[index].value = '*********';\n      inputDisabled[index] = false;\n    };\n    let remove = function (user) {\n      let id = users.value.indexOf(user);\n      axios.delete('user/' + user.id).then(e => {\n        if (e.status === 200) {\n          store.commit('removeUser', id);\n          store.commit('setNotificationInfo', {\n            titleValue: 'Успех',\n            text: `Вы успешно удалили пользователя ${user.username}`,\n            mode: 'success'\n          });\n        } else {\n          store.commit('setNotificationInfo', {\n            titleValue: 'Упс',\n            text: `Что-то пошло не так`,\n            mode: 'danger'\n          });\n        }\n      });\n    };\n    watch(users, (newUser, prevUser) => {\n      console.log(store.getters.getUsers);\n    });\n    let create = function () {\n      axios.post('user', {\n        username: newUser.username,\n        email: newUser.email,\n        password: newUser.password,\n        role: newUser.status,\n        location: newUser.location\n      }).then(e => {\n        if (e.status === 200) {\n          newUser.username = '';\n          newUser.email = '';\n          newUser.password = '';\n          newUser.role = 'ROLE_USER';\n          for (let i = 0; i < newUsers.length; i++) {\n            newUsers[i].style.border = '1px solid black';\n          }\n          store.commit('setNotificationInfo', {\n            titleValue: 'Успех',\n            text: 'Вы успешно добавили нового пользователя',\n            mode: 'success'\n          });\n        } else {\n          for (let i = 0; i < newUsers.length; i++) {\n            newUsers[i].style.border = '1px solid red';\n          }\n        }\n      });\n    };\n    return {\n      users,\n      inputDisabled,\n      saveData,\n      remove,\n      create,\n      userName,\n      userMail,\n      userPassword,\n      userStatus,\n      userLocation,\n      newUser,\n      editClick\n    };\n  }\n};","map":{"version":3,"names":["computed","onMounted","reactive","ref","watch","useStore","axios","name","setup","store","dispatch","users","getters","getUsers","inputDisabled","i","value","length","push","newUser","username","email","password","status","location","newUsers","document","getElementsByClassName","userName","userMail","userPassword","userStatus","userLocation","editClick","index","saveData","user","data","role","put","id","then","e","catch","el","console","log","message","remove","indexOf","delete","commit","titleValue","text","mode","prevUser","create","post","style","border"],"sources":["E:\\Vue\\career_guidance\\src\\components\\AdminUser.vue"],"sourcesContent":["<template>\r\n  <h2 class=\"admin__subtitle\">Управление пользователями</h2>\r\n  <table class=\"table admin__table\">\r\n    <tr>\r\n      <th>Логин</th>\r\n      <th>Почта</th>\r\n      <th>Пароль</th>\r\n      <th>Статус</th>\r\n      <th>Город</th>\r\n      <th>Изменить</th>\r\n      <th>Удалить</th>\r\n    </tr>\r\n    <tr v-for=\"(user, index) in users.slice().reverse()\" :key=\"index\">\r\n      <td>\r\n        <input\r\n            :disabled=\"!inputDisabled[index]\"\r\n            :value=\"user.username\"\r\n            class=\"admin__table-input\"\r\n            :class=\"inputDisabled[index] ? 'active' : ''\"\r\n            ref=\"userName\"\r\n        >\r\n      </td>\r\n      <td>\r\n        <input\r\n            :disabled=\"!inputDisabled[index]\"\r\n            :value=\"user.email\"\r\n            class=\"admin__table-input\"\r\n            :class=\"inputDisabled[index] ? 'active' : ''\"\r\n            ref=\"userMail\"\r\n        >\r\n      </td>\r\n      <td>\r\n        <input\r\n            :disabled=\"!inputDisabled[index]\"\r\n            value=\"********\"\r\n            class=\"admin__table-input\"\r\n            :class=\"inputDisabled[index] ? 'active' : ''\"\r\n            ref=\"userPassword\"\r\n        >\r\n      </td>\r\n      <td>\r\n        <select\r\n            :disabled=\"!inputDisabled[index]\"\r\n            class=\"admin__table-select\"\r\n            ref=\"userStatus\"\r\n            :class=\"inputDisabled[index] ? 'active' : ''\"\r\n        >\r\n          <option :selected=\"user.role === 'ROLE_USER'\" value=\"ROLE_USER\">user</option>\r\n          <option :selected=\"user.role === 'ROLE_ADMIN'\" value=\"ROLE_ADMIN\">admin</option>\r\n        </select>\r\n      </td>\r\n      <td>\r\n        <select\r\n            :disabled=\"!inputDisabled[index]\"\r\n            class=\"admin__table-input\"\r\n            ref=\"userLocation\"\r\n            :class=\"inputDisabled[index] ? 'active' : ''\"\r\n        >\r\n          <option :selected=\"user.location === 'Алматы'\" value=\"Алматы\">Алматы</option>\r\n          <option :selected=\"user.location === 'Нур-Султан'\" value=\"Нур-Султан\">Нур-Султан</option>\r\n          <option :selected=\"user.location === 'Шымкент'\" value=\"Шымкент\">Шымкент</option>\r\n          <option :selected=\"user.location === 'Туркестан'\" value=\"Туркестан\">Туркестан</option>\r\n        </select>\r\n      </td>\r\n      <td>\r\n        <img\r\n            v-if=\"!inputDisabled[index]\"\r\n            class=\"admin__table-edit\"\r\n            src=\"@/images/png/edit.png\"\r\n            alt=\"edit\"\r\n            @click=\"editClick(index)\"\r\n        >\r\n        <img\r\n            v-else\r\n            class=\"admin__table-edit\"\r\n            src=\"@/images/png/save.png\"\r\n            alt=\"edit\"\r\n            @click=\"saveData(user, index)\">\r\n      </td>\r\n      <td>\r\n        <img\r\n            v-if=\"user.role === 'ROLE_USER'\"\r\n            class=\"admin__table-edit\"\r\n            src=\"@/images/png/remove.png\"\r\n            alt=\"edit\"\r\n            @click=\"remove(user)\"\r\n        >\r\n      </td>\r\n    </tr>\r\n    <tr>\r\n      <td>\r\n        <input class=\"admin__table-input newUser\" placeholder=\"Имя\" type=\"text\" v-model=\"newUser.username\">\r\n      </td>\r\n      <td>\r\n        <input class=\"admin__table-input newUser\" placeholder=\"Почта\" type=\"text\" v-model=\"newUser.email\">\r\n      </td>\r\n      <td>\r\n        <input class=\"admin__table-input newUser\" placeholder=\"Пароль\" type=\"text\" v-model=\"newUser.password\">\r\n      </td>\r\n      <td>\r\n        <select v-model=\"newUser.status\" class=\"admin__table-select newUser\">\r\n          <option value=\"ROLE_USER\">user</option>\r\n          <option value=\"ROLE_ADMIN\">admin</option>\r\n        </select>\r\n      </td>\r\n      <td>\r\n        <select v-model=\"newUser.location\" class=\"admin__table-select newUser\">\r\n          <option value=\"Almaty\">Алматы</option>\r\n          <option value=\"Нур-Султан\">Нур-Султан</option>\r\n          <option value=\"Шымкент\">Шымкент</option>\r\n          <option value=\"Туркестан\">Туркестан</option>\r\n        </select>\r\n      </td>\r\n      <td colspan=\"2\">\r\n        <button type=\"button\" class=\"btn green small\" @click=\"create\">Создать</button>\r\n      </td>\r\n    </tr>\r\n  </table><!-- ./admin__wrapper -->\r\n</template>\r\n\r\n<script>\r\nimport {computed, onMounted, reactive, ref, watch} from \"vue\";\r\nimport {useStore} from \"vuex\";\r\nimport axios from \"axios\";\r\n\r\nexport default {\r\n  name: \"AdminUser\",\r\n  setup() {\r\n    onMounted(async () => await store.dispatch(\"setAllUsers\"))\r\n    let store = useStore();\r\n    let users = computed(() => store.getters.getUsers);\r\n\r\n    let inputDisabled = reactive([]);\r\n    for (let i = 0; i < users.value.length; i++) {\r\n      inputDisabled.push(false)\r\n    }\r\n\r\n    let newUser = reactive({\r\n      username: '',\r\n      email: '',\r\n      password: '',\r\n      status: 'ROLE_USER',\r\n      location: 'Almaty'\r\n    })\r\n\r\n    let newUsers = document.getElementsByClassName('newUser');\r\n\r\n    const userName = ref(''),\r\n        userMail = ref(''),\r\n        userPassword = ref(''),\r\n        userStatus = ref(''),\r\n        userLocation = ref('');\r\n\r\n    const editClick = function (index) {\r\n      inputDisabled[index] = !inputDisabled[index]\r\n      userPassword.value[index].value = ''\r\n    }\r\n\r\n    let saveData = async function (user, index) {\r\n      let data = {\r\n        username: userName.value[index].value,\r\n        email: userMail.value[index].value,\r\n        role: userStatus.value[index].value,\r\n        location: userLocation.value[index].value\r\n      }\r\n      if(userPassword.value[index].value) {\r\n        data[\"password\"] = userPassword.value[index].value\r\n      }\r\n      axios.put('user/' + user.id, data)\r\n          .then(e => store.dispatch('setAllUsers'))\r\n          .catch(el => console.log(el.message))\r\n      userPassword.value[index].value = '*********'\r\n      inputDisabled[index] = false;\r\n    }\r\n\r\n    let remove = function (user) {\r\n      let id = users.value.indexOf(user);\r\n      axios.delete('user/' + user.id).then(e => {\r\n        if(e.status === 200) {\r\n          store.commit('removeUser', id);\r\n          store.commit('setNotificationInfo', { titleValue: 'Успех', text: `Вы успешно удалили пользователя ${user.username}`, mode: 'success'} );\r\n        }\r\n        else {\r\n          store.commit('setNotificationInfo', { titleValue: 'Упс', text: `Что-то пошло не так`, mode: 'danger'} );\r\n        }\r\n      })\r\n    }\r\n\r\n    watch(users, (newUser, prevUser) => {\r\n      console.log(store.getters.getUsers)\r\n    });\r\n\r\n    let create = function () {\r\n      axios.post('user', {\r\n        username: newUser.username,\r\n        email: newUser.email,\r\n        password: newUser.password,\r\n        role: newUser.status,\r\n        location: newUser.location\r\n      }).then(e => {\r\n        if (e.status === 200) {\r\n          newUser.username = '';\r\n          newUser.email = '';\r\n          newUser.password = '';\r\n          newUser.role = 'ROLE_USER';\r\n          for (let i = 0; i < newUsers.length; i++) {\r\n            newUsers[i].style.border = '1px solid black'\r\n          }\r\n          store.commit('setNotificationInfo', {\r\n            titleValue: 'Успех',\r\n            text: 'Вы успешно добавили нового пользователя',\r\n            mode: 'success'\r\n          });\r\n        } else {\r\n          for (let i = 0; i < newUsers.length; i++) {\r\n            newUsers[i].style.border = '1px solid red'\r\n          }\r\n        }\r\n      })\r\n    }\r\n\r\n    return {\r\n      users,\r\n      inputDisabled,\r\n      saveData, remove, create,\r\n      userName, userMail, userPassword, userStatus, userLocation,\r\n      newUser,\r\n      editClick\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}