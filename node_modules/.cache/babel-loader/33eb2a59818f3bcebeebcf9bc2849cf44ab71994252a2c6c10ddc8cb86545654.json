{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { computed, ref } from \"vue\";\nimport { useStore } from \"vuex\";\nimport { useRoute } from \"vue-router\";\nimport router from \"@/router\";\nexport default {\n  name: \"TestTemplate\",\n  async setup() {\n    let questionNum = ref(0);\n    const store = useStore();\n    const route = useRoute();\n    await store.dispatch(\"initialQuestionList\");\n    const tests = computed(() => store.getters.getTests);\n    const users = computed(() => store.getters.getUsers);\n    const routeName = computed(() => route.params.name);\n    const test = tests.value.filter(el => el.name === routeName.value)[0].questions;\n    console.log(test);\n    let allTest = [];\n    for (let i = 0; i < test.length; i++) {\n      const innerArray = test[i].questions;\n      for (let j = 0; j < innerArray.length; j++) {\n        allTest.push(innerArray[j]);\n      }\n    }\n    let chosenAns = new Array(test.length);\n    let firstUnanswered = computed(() => test.findIndex(test => test.isAnswered === false));\n    let checkQuestionCompleted = computed(() => test.reduce((accumulator, currentValue) => accumulator + (currentValue.isAnswered ? 1 : 0), 0));\n    const sendAnswers = async chosenAns => {\n      let response = await fetch('http://localhost:8081/api/answers/send', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(chosenAns)\n      });\n      const result = await response.json();\n      return JSON.stringify(result);\n    };\n    let nextQuestion = async function (question, answer, chosenAnswer) {\n      if (checkQuestionCompleted.value + 1 !== test.length) {\n        this.test[question].isAnswered = true;\n        chosenAns[question] = chosenAnswer;\n        if (firstUnanswered.value > -1) {\n          questionNum.value = firstUnanswered.value;\n        } else {\n          questionNum.value++;\n        }\n      } else {\n        chosenAns[question] = chosenAnswer;\n        const result = await sendAnswers(chosenAns);\n        if (store.getters.getAuth) {\n          users.value.filter(el => el.id.toString() === store.getters.getUserId)[0].history = Object.entries(JSON.parse(result));\n        } else {\n          localStorage.setItem('test', result);\n        }\n        setTimeout(() => {\n          router.push('/result');\n        }, 250);\n      }\n    };\n    return {\n      questionNum,\n      test,\n      nextQuestion,\n      checkQuestionCompleted,\n      allTest: allTest\n    };\n  }\n};","map":{"version":3,"names":["computed","ref","useStore","useRoute","router","name","setup","questionNum","store","route","dispatch","tests","getters","getTests","users","getUsers","routeName","params","test","value","filter","el","questions","console","log","allTest","i","length","innerArray","j","push","chosenAns","Array","firstUnanswered","findIndex","isAnswered","checkQuestionCompleted","reduce","accumulator","currentValue","sendAnswers","response","fetch","method","headers","body","JSON","stringify","result","json","nextQuestion","question","answer","chosenAnswer","getAuth","id","toString","getUserId","history","Object","entries","parse","localStorage","setItem","setTimeout"],"sources":["E:\\Vue\\career_guidance\\src\\components\\TestTemplate.vue"],"sourcesContent":["<template>\r\n  <div class=\"test__questionCounter\">Вопрос {{ questionNum + 1 }}</div>\r\n\r\n  <div class=\"test__question\">\r\n    <div class=\"test__question-name\"> {{ allTest[questionNum].question }} </div>\r\n    <div class=\"test__question-answers\">\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div\r\n          class=\"test__question-answer\"\r\n          v-for=\"answer in allTest\"\r\n          @click=\"nextQuestion(questionNum, test[questionNum], answer)\"\r\n      >\r\n        {{ answer }}\r\n      </div>\r\n    </div>\r\n  </div><!-- ./test__question -->\r\n  <div class=\"test__passed\">\r\n    Вы ответили на\r\n    {{ checkQuestionCompleted }}\r\n    из {{ allTest.length }} вопросов\r\n  </div>\r\n  <div class=\"test__questionNums\">\r\n    <div\r\n        :class=\"test[num-1].isAnswered ? 'active': ''\"\r\n        v-for=\"num in test.length\"\r\n        @click=\"questionNum = num-1\"\r\n        class=\"test__questionNum\">{{ num }}</div>\r\n  </div><!-- ./test__questionNums -->\r\n</template>\r\n\r\n<script>\r\nimport {computed, ref} from \"vue\";\r\nimport {useStore} from \"vuex\";\r\nimport {useRoute} from \"vue-router\";\r\nimport router from \"@/router\";\r\n\r\nexport default {\r\n  name: \"TestTemplate\",\r\n  async setup() {\r\n    let questionNum = ref(0);\r\n    const store = useStore();\r\n    const route = useRoute();\r\n\r\n    await store.dispatch(\"initialQuestionList\");\r\n\r\n    const tests = computed(() => store.getters.getTests);\r\n    const users = computed(() => store.getters.getUsers);\r\n    const routeName = computed(() => route.params.name);\r\n    const test = tests.value.filter((el) => el.name === routeName.value)[0].questions;\r\n    console.log(test)\r\n    let allTest = []\r\n\r\n    for (let i = 0; i < test.length; i++) {\r\n      const innerArray = test[i].questions;\r\n      for (let j = 0; j < innerArray.length; j++) {\r\n        allTest.push(innerArray[j]);\r\n      }\r\n    }\r\n\r\n    let chosenAns = new Array(test.length);\r\n\r\n    let firstUnanswered = computed(() => test.findIndex(test => test.isAnswered === false));\r\n    let checkQuestionCompleted = computed(() => test.reduce((accumulator, currentValue) => accumulator + (currentValue.isAnswered ? 1 : 0), 0));\r\n\r\n    const sendAnswers = async (chosenAns) => {\r\n      let response = await fetch('http://localhost:8081/api/answers/send', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json'\r\n        },\r\n        body: JSON.stringify(chosenAns)\r\n      })\r\n      const result = await response.json();\r\n      return JSON.stringify(result);\r\n    }\r\n\r\n    let nextQuestion = async function (question, answer, chosenAnswer) {\r\n      if (checkQuestionCompleted.value + 1 !== test.length) {\r\n        this.test[question].isAnswered = true\r\n        chosenAns[question] = chosenAnswer;\r\n\r\n        if (firstUnanswered.value > -1) {\r\n          questionNum.value = firstUnanswered.value;\r\n        } else {\r\n          questionNum.value++;\r\n        }\r\n      }\r\n      else {\r\n        chosenAns[question] = chosenAnswer;\r\n        const result = await sendAnswers(chosenAns);\r\n        if (store.getters.getAuth) {\r\n          users.value.filter((el) => el.id.toString() === store.getters.getUserId)[0].history = Object.entries(JSON.parse(result));\r\n        }\r\n        else {\r\n          localStorage.setItem('test', result);\r\n        }\r\n        setTimeout(() => {\r\n          router.push('/result');\r\n        }, 250);\r\n      }\r\n    }\r\n    return {\r\n      questionNum,\r\n      test,\r\n      nextQuestion,\r\n      checkQuestionCompleted,\r\n      allTest: allTest\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"mappings":";AAiCA,SAAQA,QAAQ,EAAEC,GAAG,QAAO,KAAK;AACjC,SAAQC,QAAQ,QAAO,MAAM;AAC7B,SAAQC,QAAQ,QAAO,YAAY;AACnC,OAAOC,MAAK,MAAO,UAAU;AAE7B,eAAe;EACbC,IAAI,EAAE,cAAc;EACpB,MAAMC,KAAKA,CAAA,EAAG;IACZ,IAAIC,WAAU,GAAIN,GAAG,CAAC,CAAC,CAAC;IACxB,MAAMO,KAAI,GAAIN,QAAQ,EAAE;IACxB,MAAMO,KAAI,GAAIN,QAAQ,EAAE;IAExB,MAAMK,KAAK,CAACE,QAAQ,CAAC,qBAAqB,CAAC;IAE3C,MAAMC,KAAI,GAAIX,QAAQ,CAAC,MAAMQ,KAAK,CAACI,OAAO,CAACC,QAAQ,CAAC;IACpD,MAAMC,KAAI,GAAId,QAAQ,CAAC,MAAMQ,KAAK,CAACI,OAAO,CAACG,QAAQ,CAAC;IACpD,MAAMC,SAAQ,GAAIhB,QAAQ,CAAC,MAAMS,KAAK,CAACQ,MAAM,CAACZ,IAAI,CAAC;IACnD,MAAMa,IAAG,GAAIP,KAAK,CAACQ,KAAK,CAACC,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAAChB,IAAG,KAAMW,SAAS,CAACG,KAAK,CAAC,CAAC,CAAC,CAAC,CAACG,SAAS;IACjFC,OAAO,CAACC,GAAG,CAACN,IAAI;IAChB,IAAIO,OAAM,GAAI,EAAC;IAEf,KAAK,IAAIC,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAIR,IAAI,CAACS,MAAM,EAAED,CAAC,EAAE,EAAE;MACpC,MAAME,UAAS,GAAIV,IAAI,CAACQ,CAAC,CAAC,CAACJ,SAAS;MACpC,KAAK,IAAIO,CAAA,GAAI,CAAC,EAAEA,CAAA,GAAID,UAAU,CAACD,MAAM,EAAEE,CAAC,EAAE,EAAE;QAC1CJ,OAAO,CAACK,IAAI,CAACF,UAAU,CAACC,CAAC,CAAC,CAAC;MAC7B;IACF;IAEA,IAAIE,SAAQ,GAAI,IAAIC,KAAK,CAACd,IAAI,CAACS,MAAM,CAAC;IAEtC,IAAIM,eAAc,GAAIjC,QAAQ,CAAC,MAAMkB,IAAI,CAACgB,SAAS,CAAChB,IAAG,IAAKA,IAAI,CAACiB,UAAS,KAAM,KAAK,CAAC,CAAC;IACvF,IAAIC,sBAAqB,GAAIpC,QAAQ,CAAC,MAAMkB,IAAI,CAACmB,MAAM,CAAC,CAACC,WAAW,EAAEC,YAAY,KAAKD,WAAU,IAAKC,YAAY,CAACJ,UAAS,GAAI,IAAI,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;IAE3I,MAAMK,WAAU,GAAI,MAAOT,SAAS,IAAK;MACvC,IAAIU,QAAO,GAAI,MAAMC,KAAK,CAAC,wCAAwC,EAAE;QACnEC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAChB,SAAS;MAChC,CAAC;MACD,MAAMiB,MAAK,GAAI,MAAMP,QAAQ,CAACQ,IAAI,EAAE;MACpC,OAAOH,IAAI,CAACC,SAAS,CAACC,MAAM,CAAC;IAC/B;IAEA,IAAIE,YAAW,GAAI,eAAAA,CAAgBC,QAAQ,EAAEC,MAAM,EAAEC,YAAY,EAAE;MACjE,IAAIjB,sBAAsB,CAACjB,KAAI,GAAI,MAAMD,IAAI,CAACS,MAAM,EAAE;QACpD,IAAI,CAACT,IAAI,CAACiC,QAAQ,CAAC,CAAChB,UAAS,GAAI,IAAG;QACpCJ,SAAS,CAACoB,QAAQ,IAAIE,YAAY;QAElC,IAAIpB,eAAe,CAACd,KAAI,GAAI,CAAC,CAAC,EAAE;UAC9BZ,WAAW,CAACY,KAAI,GAAIc,eAAe,CAACd,KAAK;QAC3C,OAAO;UACLZ,WAAW,CAACY,KAAK,EAAE;QACrB;MACF,OACK;QACHY,SAAS,CAACoB,QAAQ,IAAIE,YAAY;QAClC,MAAML,MAAK,GAAI,MAAMR,WAAW,CAACT,SAAS,CAAC;QAC3C,IAAIvB,KAAK,CAACI,OAAO,CAAC0C,OAAO,EAAE;UACzBxC,KAAK,CAACK,KAAK,CAACC,MAAM,CAAEC,EAAE,IAAKA,EAAE,CAACkC,EAAE,CAACC,QAAQ,EAAC,KAAMhD,KAAK,CAACI,OAAO,CAAC6C,SAAS,CAAC,CAAC,CAAC,CAAC,CAACC,OAAM,GAAIC,MAAM,CAACC,OAAO,CAACd,IAAI,CAACe,KAAK,CAACb,MAAM,CAAC,CAAC;QAC1H,OACK;UACHc,YAAY,CAACC,OAAO,CAAC,MAAM,EAAEf,MAAM,CAAC;QACtC;QACAgB,UAAU,CAAC,MAAM;UACf5D,MAAM,CAAC0B,IAAI,CAAC,SAAS,CAAC;QACxB,CAAC,EAAE,GAAG,CAAC;MACT;IACF;IACA,OAAO;MACLvB,WAAW;MACXW,IAAI;MACJgC,YAAY;MACZd,sBAAsB;MACtBX,OAAO,EAAEA;IACX;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}